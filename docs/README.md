# QuickPM æŠ€æœ¯æ–‡æ¡£ä¸­å¿ƒ

**é¡¹ç›®ï¼š** QuickPM - AI é©±åŠ¨çš„äº§å“ç»ç†å­¦ä¹ å¹³å°  
**æ¡†æ¶ï¼š** Flutter Web + Firebase + Gemini API  
**æ›´æ–°æ—¥æœŸï¼š** 2026-01-20

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### 1ï¸âƒ£ æ•°æ®å­˜å‚¨æ¶æ„è®¾è®¡ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
**æ–‡ä»¶ï¼š** [`DATA_STORAGE_ARCHITECTURE.md`](./DATA_STORAGE_ARCHITECTURE.md)

**æ¶µç›–å†…å®¹ï¼š**
- âœ… å®Œæ•´çš„ Firestore æ•°æ®åº“ç»“æ„è®¾è®¡
- âœ… è®¤è¯ç­–ç•¥ï¼ˆåŒ¿åç™»å½• â†’ æ­£å¼è´¦å·å‡çº§ï¼‰
- âœ… æ•°æ®ç±»å‹ä¸å­˜å‚¨ä½ç½®è¯¦è§£
- âœ… å®‰å…¨è§„åˆ™é…ç½®
- âœ… æ•°æ®è¿ç§»ç­–ç•¥

**é€‚ç”¨åœºæ™¯ï¼š**
- ç†è§£æ•´ä¸ªåº”ç”¨çš„æ•°æ®æ¨¡å‹
- è®¾è®¡æ–°åŠŸèƒ½æ—¶ç¡®å®šæ•°æ®å­˜å‚¨ä½ç½®
- é…ç½® Firestore å®‰å…¨è§„åˆ™

**å¿«é€ŸæŸ¥é˜…ï¼š**
```
ğŸ“Š å®˜æ–¹çŸ¥è¯†ç‚¹ â†’ /feed_items/{itemId}
ğŸ‘¤ ç”¨æˆ·é…ç½® â†’ /users/{uid}/profile
ğŸ“ˆ å­¦ä¹ è¿›åº¦ â†’ /users/{uid}/learning_progress/{feedItemId}
ğŸ“ ç”¨æˆ·ç¬”è®° â†’ /users/{uid}/user_notes/{noteId}
âœ¨ è‡ªå®šä¹‰å†…å®¹ â†’ /users/{uid}/custom_items/{customItemId}
âš”ï¸ é¢ç»æ–‡æ¡£ â†’ /users/{uid}/war_room_docs/{docId}
```

---

### 2ï¸âƒ£ Gemini API é›†æˆä¸è¿ç§»æŒ‡å—
**æ–‡ä»¶ï¼š** [`GEMINI_API_MIGRATION.md`](./GEMINI_API_MIGRATION.md)

**æ¶µç›–å†…å®¹ï¼š**
- âœ… ä» Firebase Vertex AI åˆ‡æ¢åˆ° Gemini Developer API
- âœ… API Key è·å–ä¸ç®¡ç†ç­–ç•¥
- âœ… ä»£ç ä¿®æ”¹è¯¦è§£ï¼ˆå«å®Œæ•´ç¤ºä¾‹ï¼‰
- âœ… Gemini 2.0 Flash æ–°ç‰¹æ€§ä»‹ç»
- âœ… æˆæœ¬ä¼°ç®—ä¸å…è´¹é¢åº¦è¯´æ˜

**é€‚ç”¨åœºæ™¯ï¼š**
- é…ç½® Gemini API
- å®ç° AI å†…å®¹ç”ŸæˆåŠŸèƒ½
- API Key å®‰å…¨ç®¡ç†

**å¿«é€Ÿæ“ä½œï¼š**
```bash
# 1. è·å– API Key
è®¿é—®: https://aistudio.google.com/app/apikey

# 2. å®‰è£…ä¾èµ–
flutter pub add google_generative_ai

# 3. è¿è¡Œåº”ç”¨ï¼ˆä¼ å…¥ API Keyï¼‰
flutter run -d web-server --dart-define=GEMINI_API_KEY=YOUR_KEY
```

---

### 3ï¸âƒ£ API ä¸æ•°æ®åº“å¿«é€Ÿå‚è€ƒ
**æ–‡ä»¶ï¼š** [`API_AND_DATABASE_GUIDE.md`](./API_AND_DATABASE_GUIDE.md)

**æ¶µç›–å†…å®¹ï¼š**
- âœ… å½“å‰å®ç°çŠ¶æ€æ€»è§ˆ
- âœ… Firebase é¡¹ç›®é…ç½®ä¿¡æ¯
- âœ… å·²å®ç°å’Œå¾…å®Œå–„çš„åŠŸèƒ½æ¸…å•
- âœ… å¿«é€Ÿé—®é¢˜æ’æŸ¥

**é€‚ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿäº†è§£é¡¹ç›®ç°çŠ¶
- æ£€æŸ¥å“ªäº›åŠŸèƒ½å·²ç»å®Œæˆ
- æ’æŸ¥æ•°æ®ä¿å­˜é—®é¢˜

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### é¦–æ¬¡è®¾ç½®

1. **å…‹éš†é¡¹ç›®å¹¶å®‰è£…ä¾èµ–**
   ```bash
   cd QuickPM
   flutter pub get
   ```

2. **é…ç½® Gemini API Key**
   
   é€‰æ‹©ä»¥ä¸‹ä»»ä¸€æ–¹å¼ï¼š
   
   **æ–¹å¼ Aï¼šç¯å¢ƒå˜é‡ï¼ˆå¼€å‘ï¼‰**
   ```bash
   flutter run -d web-server --web-port 3000 \
     --dart-define=GEMINI_API_KEY=AIzaSyC_YOUR_KEY
   ```
   
   **æ–¹å¼ Bï¼šç”¨æˆ·æä¾›ï¼ˆç”Ÿäº§ï¼‰**
   - åœ¨åº”ç”¨çš„ä¸ªäººä¸­å¿ƒæ·»åŠ  API Key è¾“å…¥æ¡†
   - ç”¨æˆ·è‡ªè¡Œæä¾› API Key
   - å­˜å‚¨åˆ° Firestoreï¼š`/users/{uid}/profile`

3. **éƒ¨ç½² Firestore å®‰å…¨è§„åˆ™**
   ```bash
   firebase deploy --only firestore:rules
   ```

---

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        QuickPM æ¶æ„å›¾                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ğŸ“± Flutter Web App                                             â”‚
â”‚  â”œâ”€ Riverpod (çŠ¶æ€ç®¡ç†)                                         â”‚
â”‚  â”œâ”€ go_router (è·¯ç”±)                                            â”‚
â”‚  â””â”€ flutter_markdown (å†…å®¹æ¸²æŸ“)                                 â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ğŸ”¥ Firebase Backend                                            â”‚
â”‚  â”œâ”€ Authentication (åŒ¿å + é‚®ç®±/Google)                         â”‚
â”‚  â”œâ”€ Firestore (æ•°æ®åº“)                                          â”‚
â”‚  â”‚   â”œâ”€ /feed_items (å®˜æ–¹å†…å®¹)                                 â”‚
â”‚  â”‚   â””â”€ /users/{uid}/ (ç”¨æˆ·æ•°æ®)                               â”‚
â”‚  â””â”€ Hosting (éƒ¨ç½²)                                              â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ğŸ¤– Gemini 2.0 Flash API                                        â”‚
â”‚  â”œâ”€ ç”ŸæˆçŸ¥è¯†å¡ç‰‡                                                â”‚
â”‚  â”œâ”€ AI é—®ç­”ç¬”è®°                                                 â”‚
â”‚  â””â”€ é¢ç»å†…å®¹å…‹éš†                                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯è§†åŒ–æ¶æ„å›¾

![QuickPM æŠ€æœ¯æ¶æ„](../artifacts/quickpm_data_architecture.png)

---

## ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½å®ç°çŠ¶æ€

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | æ–‡æ¡£å‚è€ƒ |
|---------|------|---------|
| ğŸ“š å®˜æ–¹çŸ¥è¯†ç‚¹å±•ç¤º | âœ… å®Œæˆ | DATA_STORAGE_ARCHITECTURE.md |
| ğŸ” åŒ¿åç™»å½• | âœ… å®Œæˆ | DATA_STORAGE_ARCHITECTURE.md (ç¬¬2ç« ) |
| ğŸ“ˆ å­¦ä¹ è¿›åº¦è¿½è¸ª | âœ… å®Œæˆ | DATA_STORAGE_ARCHITECTURE.md (ç¬¬4.2èŠ‚) |
| â¤ï¸ æ”¶è—åŠŸèƒ½ | âœ… å®Œæˆ | - |
| ğŸ¤– AI ç”ŸæˆçŸ¥è¯†ç‚¹ | âš ï¸ å‰ç«¯å®Œæˆï¼ŒæŒä¹…åŒ–å¾…å®Œå–„ | GEMINI_API_MIGRATION.md |
| ğŸ“ AI é—®ç­”ç¬”è®° | âš ï¸ UI å®Œæˆï¼Œä¿å­˜å¾…å®ç° | DATA_STORAGE_ARCHITECTURE.md (ç¬¬4.3èŠ‚) |
| ğŸ§  SRS å¤ä¹ ç³»ç»Ÿ | âš ï¸ ç®—æ³•å®Œæˆï¼Œæ›´æ–°å¾…ä¼˜åŒ– | - |
| âš”ï¸ é¢ç»å…‹éš† | ğŸ“‹ å¾…å¼€å‘ | DATA_STORAGE_ARCHITECTURE.md (ç¬¬4.6èŠ‚) |
| ğŸ‘¤ è´¦å·å‡çº§ | ğŸ“‹ å¾…å¼€å‘ | DATA_STORAGE_ARCHITECTURE.md (ç¬¬2.2èŠ‚) |

**å›¾ä¾‹ï¼š**
- âœ… å®Œæˆï¼šåŠŸèƒ½å·²å®ç°ä¸”ç»è¿‡æµ‹è¯•
- âš ï¸ éƒ¨åˆ†å®Œæˆï¼šæ ¸å¿ƒé€»è¾‘å®Œæˆï¼Œä½†éœ€è¦å®Œå–„
- ğŸ“‹ å¾…å¼€å‘ï¼šå·²è®¾è®¡ï¼Œå°šæœªå¼€å§‹ç¼–ç 

---

## ğŸ“ å¾…åŠäº‹é¡¹ (TODO)

### é«˜ä¼˜å…ˆçº§

1. **å®Œå–„ AI ç”Ÿæˆå†…å®¹çš„æŒä¹…åŒ–**
   - [ ] ä¿®æ”¹ `add_material_modal.dart` çš„ä¿å­˜é€»è¾‘
   - [ ] åœ¨ `FirestoreService` ä¸­æ·»åŠ  `saveCustomFeedItem` æ–¹æ³•
   - [ ] æµ‹è¯•æ•°æ®ä¿å­˜å’Œè¯»å–æµç¨‹
   - ğŸ“– å‚è€ƒï¼š`DATA_STORAGE_ARCHITECTURE.md` ç¬¬4.4èŠ‚

2. **å®ç°ç”¨æˆ·ç¬”è®°ä¿å­˜**
   - [ ] å®Œå–„ `saveUserNote` æ–¹æ³•
   - [ ] åœ¨ Feed é¡µé¢åŠ¨æ€åŠ è½½ç”¨æˆ·ç¬”è®°
   - [ ] æµ‹è¯• Pin åŠŸèƒ½çš„å®Œæ•´æµç¨‹
   - ğŸ“– å‚è€ƒï¼š`DATA_STORAGE_ARCHITECTURE.md` ç¬¬4.3èŠ‚

3. **åˆ‡æ¢åˆ° Gemini Developer API**
   - [ ] è·å– Gemini API Key
   - [ ] æ›´æ–°ä¾èµ–ï¼š`google_generative_ai`
   - [ ] ä¿®æ”¹ `ContentGeneratorService`
   - [ ] é€‰æ‹© API Key ç®¡ç†ç­–ç•¥
   - ğŸ“– å‚è€ƒï¼š`GEMINI_API_MIGRATION.md`

### ä¸­ä¼˜å…ˆçº§

4. **éƒ¨ç½² Firestore å®‰å…¨è§„åˆ™**
   - [ ] å¤åˆ¶ `DATA_STORAGE_ARCHITECTURE.md` ç¬¬5ç« çš„è§„åˆ™
   - [ ] åˆ›å»º `firestore.rules` æ–‡ä»¶
   - [ ] è¿è¡Œ `firebase deploy --only firestore:rules`

5. **ä¼˜åŒ– SRS ç®—æ³•**
   - [ ] å®ç° `updateSRSStatus` çš„æ•°æ®åº“å†™å…¥
   - [ ] æ·»åŠ å¤ä¹ æé†’é€»è¾‘
   - [ ] æµ‹è¯•é—´éš”å¤ä¹ æµç¨‹

### ä½ä¼˜å…ˆçº§

6. **å®ç°è´¦å·å‡çº§åŠŸèƒ½**
   - [ ] æ·»åŠ é‚®ç®±ç»‘å®š UI
   - [ ] å®ç° `linkWithCredential` é€»è¾‘
   - [ ] æµ‹è¯•æ•°æ®è¿ç§»

7. **å¼€å‘é¢ç»å…‹éš†æ¨¡å—**
   - [ ] åˆ›å»º War Room é¡µé¢
   - [ ] å®ç°æ¨¡æ¿åº“
   - [ ] é›†æˆ AI å…‹éš†åŠŸèƒ½

---

## ğŸ› ï¸ å¼€å‘å·¥å…·é“¾

### æ¨èçš„ IDE æ’ä»¶
- Flutter (Dart)
- Firebase Tools
- Markdown Preview
- GitLens

### å¸¸ç”¨å‘½ä»¤

```bash
# å¼€å‘è¿è¡Œ
flutter run -d web-server --web-port 3000

# æ£€æŸ¥ä»£ç é”™è¯¯
flutter analyze

# æ ¼å¼åŒ–ä»£ç 
flutter format lib/

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
flutter build web

# éƒ¨ç½²åˆ° Firebase Hosting
firebase deploy --only hosting

# æŸ¥çœ‹ Firestore æ•°æ®
firebase firestore:indexes  # æŸ¥çœ‹ç´¢å¼•
```

---

## ğŸ“Š æ•°æ®æµç¤ºä¾‹

### ç”¨æˆ·ä¸Šä¼ å­¦ä¹ èµ„æ–™çš„å®Œæ•´æµç¨‹

```
1ï¸âƒ£ ç”¨æˆ·æ“ä½œ
   â””â”€ ç‚¹å‡» "Add Material" â†’ ç²˜è´´æ–‡æœ¬ â†’ ç‚¹å‡» "ç”ŸæˆçŸ¥è¯†å¡ç‰‡"

2ï¸âƒ£ AI å¤„ç†
   â””â”€ ContentGeneratorService.generateFromText()
       â””â”€ è°ƒç”¨ Gemini 2.0 Flash API
           â””â”€ è¿”å›ç»“æ„åŒ–çš„ JSONï¼ˆå¤šä¸ª FeedItemï¼‰

3ï¸âƒ£ æ•°æ®ä¿å­˜ï¼ˆå¾…å®Œå–„ï¼‰
   â””â”€ å½“å‰ï¼šåªä¿å­˜åˆ°å†…å­˜ (Provider state)
   â””â”€ ç›®æ ‡ï¼šä¿å­˜åˆ° Firestore
       â””â”€ è·¯å¾„ï¼š/users/{uid}/custom_items/{itemId}
           â””â”€ åŒ…å«ï¼štitle, category, difficulty, pages, createdAt

4ï¸âƒ£ æ•°æ®è¯»å–
   â””â”€ FeedProvider åˆå¹¶æ˜¾ç¤º
       â”œâ”€ å®˜æ–¹å†…å®¹ï¼š/feed_items/
       â””â”€ ç”¨æˆ·å†…å®¹ï¼š/users/{uid}/custom_items/

5ï¸âƒ£ ç”¨æˆ·å­¦ä¹ 
   â””â”€ è®°å½•è¿›åº¦ï¼š/users/{uid}/learning_progress/{feedItemId}
   â””â”€ æ·»åŠ ç¬”è®°ï¼š/users/{uid}/user_notes/{noteId}
```

---

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

1. **æ°¸è¿œä¸è¦å°† API Key æäº¤åˆ° Git**
   ```bash
   # æ·»åŠ åˆ° .gitignore
   echo "lib/config/secrets.dart" >> .gitignore
   ```

2. **ä½¿ç”¨ç¯å¢ƒå˜é‡**
   ```bash
   --dart-define=GEMINI_API_KEY=xxx
   ```

3. **é™åˆ¶ API è°ƒç”¨**
   - æ¯ä¸ªç”¨æˆ·æ¯æ—¥é™é¢
   - å­˜å‚¨åœ¨ Firestoreï¼š`aiUsageCount`

4. **Firestore è§„åˆ™ä¸¥æ ¼æ¨¡å¼**
   ```javascript
   // é»˜è®¤æ‹’ç»æ‰€æœ‰è®¿é—®
   match /{document=**} {
     allow read, write: if false;
   }
   
   // é€ä¸ªé›†åˆé…ç½®
   match /users/{uid} {
     allow read, write: if request.auth.uid == uid;
   }
   ```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šç‚¹å‡» "Add Material" æ²¡ååº”
**è§£å†³æ–¹æ¡ˆï¼š** å·²ä¿®å¤ï¼ˆ2026-01-20ï¼‰
- æŸ¥çœ‹ï¼š`lib/features/home/presentation/widgets/home_tab.dart` ç¬¬253è¡Œ
- ç¡®ä¿ `onPressed` è°ƒç”¨äº† `showDialog(AddMaterialModal())`

### é—®é¢˜ 2ï¼šAI ç”Ÿæˆååˆ·æ–°é¡µé¢ä¸¢å¤±
**åŸå› ï¼š** æ•°æ®åªä¿å­˜åœ¨å†…å­˜ä¸­
**è§£å†³æ–¹æ¡ˆï¼š** å‚è€ƒ `DATA_STORAGE_ARCHITECTURE.md` ç¬¬4.4èŠ‚å®ç°æŒä¹…åŒ–

### é—®é¢˜ 3ï¼šGemini API è¿”å› 403 é”™è¯¯
**å¯èƒ½åŸå› ï¼š**
- API Key æ— æ•ˆ
- é…é¢ç”¨å®Œ
**è§£å†³æ–¹æ¡ˆï¼š** æ£€æŸ¥ API Keyï¼ŒæŸ¥çœ‹ [Google AI Studio](https://aistudio.google.com/)

### é—®é¢˜ 4ï¼šFirestore è¯»å–æƒé™è¢«æ‹’ç»
**è§£å†³æ–¹æ¡ˆï¼š** ç¡®ä¿ç”¨æˆ·å·²ç™»å½•ï¼Œæ£€æŸ¥å®‰å…¨è§„åˆ™æ˜¯å¦æ­£ç¡®éƒ¨ç½²

---

## ğŸ“ è·å–å¸®åŠ©

- ğŸ“– **å®˜æ–¹æ–‡æ¡£**
  - [Flutter](https://flutter.dev/docs)
  - [Firebase](https://firebase.google.com/docs)
  - [Gemini API](https://ai.google.dev/docs)

- ğŸ’¬ **ç¤¾åŒºæ”¯æŒ**
  - Stack Overflow
  - Flutter Discord
  - Firebase Community

---

**æœ€åæ›´æ–°ï¼š** 2026-01-20  
**ç»´æŠ¤è€…ï¼š** QuickPM Team  
**ç‰ˆæœ¬ï¼š** v1.0 (MVP)
